machalilla.fixed$month<-as.numeric(machalilla.fixed$month)
#machalilla.fixed$camera_trap_start_date<-as.Date(as.character(machalilla.fixed$camera_trap_start_date),  "%Y-%m-%d")
#machalilla.fixed$camera_trap_end_date<-as.Date(as.character(machalilla.fixed$camera_trap_end_date),  "%Y-%m-%d")
# library(dplyr)
mat.per.sp<-f.matrix.creator2(data = machalilla.fixed,year = 2014)
sp.names<-names(mat.per.sp) # species names
# counting how many (total) records per species by all days
cont.per.sp<-data.frame(row.names = sp.names)
row.per.sp<-as.data.frame(matrix(nrow = length(sp.names), ncol=c(59)))
col.per.sp<-as.data.frame(matrix(nrow = length(sp.names), ncol=c(161)))
rownames(row.per.sp)<-sp.names
rownames(col.per.sp)<-sp.names
for (i in 1:length(mat.per.sp)){
cont.per.sp[i,1]<-sum(apply(as.data.frame(mat.per.sp [[i]]),FUN=sum,na.rm=T, MARGIN = 1))
row.per.sp[i,]<-apply(mat.per.sp[[i]],1, function(x) sum(x, na.rm=T))
# row.per.sp[i,which(row.per.sp[i,]>0)]<-1 # convert to presence absence  1 and 0
col.per.sp[i,]<-apply(mat.per.sp[[i]],2, function(x) sum(x, na.rm=T))
# col.per.sp[i,which(col.per.sp[i,]>0)]<-1 # convert to presence absence  1 and 0
}
#### se full mat
row.per.sp
# colnames(row.per.sp)<-rep
# cont.per.sp$especie<-rownames(cont.per.sp)
# colnames(cont.per.sp)<-c("Numero_de_fotos","especie")
##################################################
### Just wild mammals not including domesticated
##################################################
# Chk names in sp.names Myotis myotis should be Artibeus sp
row.per.sp<-row.per.sp[-37,] # elimina Pheucticus chrysogaster
row.per.sp<-row.per.sp[-36,] # elimina Cathartes aura
row.per.sp<-row.per.sp[-35,] # elimina Gallus gallus
row.per.sp<-row.per.sp[-34,] # elimina Zenaida auriculata
row.per.sp<-row.per.sp[-33,] # elimina Momotus momota
row.per.sp<-row.per.sp[-30,] # elimina Heliomaster longirostris
row.per.sp<-row.per.sp[-29,] # elimina Pipistrellus pipistrellus
row.per.sp<-row.per.sp[-26,] # elimina Ortalis vetula
row.per.sp<-row.per.sp[-25,] # elimina Homo sapiens
row.per.sp<-row.per.sp[-21,] # elimina Tinamus major
row.per.sp<-row.per.sp[-16,] # elimina Equus africanus
row.per.sp<-row.per.sp[-15,] # elimina Sus scrofa
row.per.sp<-row.per.sp[-14,] # elimina Rattus rattus
row.per.sp<-row.per.sp[-12,] # elimina Equus ferus
row.per.sp<-row.per.sp[-10,] # elimina Bos primigenius
row.per.sp<-row.per.sp[-07,] # elimina Buteogallus urubitinga
row.per.sp<-row.per.sp[-04,] # elimina Leptotila verreauxi
row.per.sp<-row.per.sp[-03,] # elimina Capra aegagrus
row.per.sp<-row.per.sp[-02,] # elimina Canis lupus
row.per.sp<-row.per.sp[-01,] # elimina 1a sp
# row.per.sp<-row.per.sp[-10,] # elimina Leptotila verreauxi
# row.per.sp<-row.per.sp[-08,] # elimina Tinamus major
# row.per.sp<-row.per.sp[-01,] # elimina 1era especie vacia
######### CHK names
rownames(row.per.sp)
row.per.sp
# library(xtable)
library(lubridate)
library(dplyr)
library(maptools)
# Load 'rgdal' package, which is used to read/write shapefiles and rasters
library(rgdal)
source("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/code/TEAM_code.R")
source("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/code/calendar.R")
machalilla.raw<-read.csv("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/Data/CT-PNM-2014.csv") # ojo falta la camara 3-12 asume diden worked?
#############################
#### date fix
#############################
# unique(year(machalilla.raw$camera_trap_start_time))
machalilla.raw$photo_date2<-as.Date(as.character(machalilla.raw$photo_date), "%d-%b-%Y")
machalilla.raw$Sampling.Period<-2014
machalilla.raw$binomial<-paste(machalilla.raw$genus, machalilla.raw$specise, sep = " ")
#############################
# translate months
#############################
#
# meses<-as.data.frame(t(matrix(c("ago","aug","dic","dec","ene","jan","abr","apr"),nrow = 2,ncol = 4)))
# machalilla.raw$camera_trap_start_time2<-NA
# machalilla.raw$camera_trap_end_time2<-NA
# for (i in 1:4){
# # get month
#   chkmes<-substr(as.character(machalilla.raw$photo_date), start=4, stop=6)
#   chkmes2<-substr(as.character(machalilla.raw$camera_trap_start_time), start=4, stop=6)
#   chkmes3<-substr(as.character(machalilla.raw$camera_trap_end_time), start=4, stop=6)
#   # chane month
#   agoind<-which(chkmes == meses[i,1])
#   agoind2<-which(chkmes2 == meses[i,1])
#   agoind3<-which(chkmes3 == meses[i,1])
#   # machalilla.raw$photo_date[agoind]
#   machalilla.raw$photo_date2[agoind]<-as.Date(gsub(as.character(meses[i,1]),
#                                                      as.character(meses[i,2]),
#                                                      machalilla.raw$photo_date[agoind]), "%d-%b-%Y")
#
#   machalilla.raw$camera_trap_start_time2[agoind2]<-as.Date(gsub(as.character(meses[i,1]),
#                                                    as.character(meses[i,2]),
#                                                    machalilla.raw$camera_trap_start_time[agoind2]), "%d-%b-%Y")
#
#   machalilla.raw$camera_trap_end_time2[agoind3]<-as.Date(gsub(as.character(meses[i,1]),
#                                                                as.character(meses[i,2]),
#                                                                machalilla.raw$camera_trap_end_time[agoind3]), "%d-%b-%Y")
# }
#
# # tochk
# # unique(machalilla.raw$photo_date2)
machalilla.raw$camera_trap_start_date<-as.Date(substr(as.character(machalilla.raw$camera_trap_start_time), start=1, stop=11), "%d-%b-%Y")
machalilla.raw$camera_trap_end_date<-as.Date(substr(as.character(machalilla.raw$camera_trap_end_time), start=1, stop=11), "%d-%b-%Y")
#################################
# Fix 2011 problem
# Two cameras have date wrong
# CT-PNM-1-7  and  CT-PNM-3-10
# Fix start date manually
################################
# identify the problem
# index_problem_2011<-which(machalilla.raw$camera_trap_start_date == "2011-11-11")
# problem_2011<-machalilla.raw[index_problem_2011,]
# unique(problem_2011$camera_trap)
# fix 1-7 just year
index_1_07<-which(machalilla.raw$camera_trap == "CT-PNM-1-7")
cam_1_07<-machalilla.raw[index_1_07, ] # make data frame using the cam
machalilla.raw<-machalilla.raw[-index_1_07 ,] # remove the cam
cam_1_07$camera_trap_start_date<-as.Date("2014-09-23", format="%Y-%m-%d")
cam_1_07<-cam_1_07[-1,] # borra el primero porblematic 2011
cam_1_07$photo_type[1]<-"Start" # fix start
cam_1_07$camera_trap_end_date<-as.Date("2014-11-06", format="%Y-%m-%d")
# fix 1-10  # add 31 days since data setup pickup en data 12 and beyond
index_1_10<-which(machalilla.raw$camera_trap == "CT-PNM-1-10")
cam_1_10<-machalilla.raw[index_1_10, ]
machalilla.raw<-machalilla.raw[-index_1_10 ,]
cam_1_10$camera_trap_start_date<-as.Date("2014-09-23", format="%Y-%m-%d")
cam_1_10$camera_trap_end_date<-as.Date("2014-11-05", format="%Y-%m-%d")
cam_1_10$photo_date2[c(12:875)]<-cam_1_10$photo_date2[c(12:875)] +31
# delete problematic data
cam_1_10<-cam_1_10[-24,]
cam_1_10<-cam_1_10[-25,]
# fix 3-10  # restar 30 dias
index_3_10<-which(machalilla.raw$camera_trap == "CT-PNM-3-10")
cam_3_10<-machalilla.raw[index_3_10, ]
machalilla.raw<-machalilla.raw[-index_3_10 ,]
cam_3_10$camera_trap_start_date<-as.Date("2015-01-27", format="%Y-%m-%d")
cam_3_10$camera_trap_end_date<-as.Date("2015-03-15", format="%Y-%m-%d")
# borra los primeros 30 problematicos con fecha 2011
cam_3_10<-cam_3_10[-c(1:30),]
cam_3_10$photo_date2<-cam_3_10$photo_date2  - 30
# fix 3-07 # add difference of 365 days
index_3_07<-which(machalilla.raw$camera_trap == "CT-PNM-3-07")
cam_3_07<-machalilla.raw[index_3_07, ]
machalilla.raw<-machalilla.raw[- index_3_07 ,]
cam_3_07$camera_trap_start_date<-as.Date("2015-01-27", format="%Y-%m-%d")
cam_3_07$camera_trap_end_date<-as.Date("2015-03-11", format="%Y-%m-%d")
cam_3_07$photo_date2<- cam_3_07$photo_date2 + 365
### remove from machalilla.raw
# machalilla.raw<-machalilla.raw[-index_1_07 ,]
# machalilla.raw<-machalilla.raw[-index_3_10 ,]
# machalilla.raw<-machalilla.raw[-index_3_07 ,]
#### Add corrected
machalilla.raw<-rbind(machalilla.raw, cam_1_07, cam_1_10, cam_3_10, cam_3_07)
# machalilla.raw<-rbind(machalilla.raw, cam_1_10)
# machalilla.raw<-rbind(machalilla.raw, cam_3_10)
# machalilla.raw<-rbind(machalilla.raw, cam_3_07)
#  problematic ?
# which(machalilla.raw$photo_date2 == "2011-11-11")
# which(machalilla.raw$camera_trap == "CT-PNM-1-10")
########## extract yr and month
machalilla.raw$year<-year(machalilla.raw$photo_date2)
machalilla.raw$month<-month(machalilla.raw$photo_date2)
# problem?
# which(machalilla.raw$year == "2011")
dir()
save(machalilla.raw, f="data/machalilla.fixed")
save(machalilla.raw, f="/data/machalilla.fixed.R")
save(machalilla.raw, f="/data/machalilla_fixed.R")
save(machalilla.raw, file = "/data/machalilla_fixed.RData")
dir()
save(machalilla.raw, file = "/data/machalilla_fixed.RData")
save(machalilla.raw, file = "machalilla_fixed.RData")
machalilla.fixed<-load(file = "data/machalilla_fixed.RData")
mat.per.sp<-f.matrix.creator2(data = machalilla.fixed,year = 2014)
source("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/code/TEAM_code.R")
library(rgdal)
source("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/code/TEAM_code.R")
library(lubridate)
# library(dplyr)
library(maptools)
# Load 'rgdal' package, which is used to read/write shapefiles and rasters
library(rgdal)
source("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/code/TEAM_code.R")
# source("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/code/calendar.R")
machalilla.fixed<-load(file = "data/machalilla_fixed.RData")
# library(xtable)
library(lubridate)
library(dplyr)
library(maptools)
# Load 'rgdal' package, which is used to read/write shapefiles and rasters
library(rgdal)
source("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/code/TEAM_code.R")
source("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/code/calendar.R")
machalilla.raw<-read.csv("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/Data/CT-PNM-2014.csv") # ojo falta la camara 3-12 asume diden worked?
#############################
#### date fix
#############################
# unique(year(machalilla.raw$camera_trap_start_time))
machalilla.raw$photo_date2<-as.Date(as.character(machalilla.raw$photo_date), "%d-%b-%Y")
machalilla.raw$Sampling.Period<-2014
machalilla.raw$binomial<-paste(machalilla.raw$genus, machalilla.raw$specise, sep = " ")
#############################
# translate months
#############################
#
# meses<-as.data.frame(t(matrix(c("ago","aug","dic","dec","ene","jan","abr","apr"),nrow = 2,ncol = 4)))
# machalilla.raw$camera_trap_start_time2<-NA
# machalilla.raw$camera_trap_end_time2<-NA
# for (i in 1:4){
# # get month
#   chkmes<-substr(as.character(machalilla.raw$photo_date), start=4, stop=6)
#   chkmes2<-substr(as.character(machalilla.raw$camera_trap_start_time), start=4, stop=6)
#   chkmes3<-substr(as.character(machalilla.raw$camera_trap_end_time), start=4, stop=6)
#   # chane month
#   agoind<-which(chkmes == meses[i,1])
#   agoind2<-which(chkmes2 == meses[i,1])
#   agoind3<-which(chkmes3 == meses[i,1])
#   # machalilla.raw$photo_date[agoind]
#   machalilla.raw$photo_date2[agoind]<-as.Date(gsub(as.character(meses[i,1]),
#                                                      as.character(meses[i,2]),
#                                                      machalilla.raw$photo_date[agoind]), "%d-%b-%Y")
#
#   machalilla.raw$camera_trap_start_time2[agoind2]<-as.Date(gsub(as.character(meses[i,1]),
#                                                    as.character(meses[i,2]),
#                                                    machalilla.raw$camera_trap_start_time[agoind2]), "%d-%b-%Y")
#
#   machalilla.raw$camera_trap_end_time2[agoind3]<-as.Date(gsub(as.character(meses[i,1]),
#                                                                as.character(meses[i,2]),
#                                                                machalilla.raw$camera_trap_end_time[agoind3]), "%d-%b-%Y")
# }
#
# # tochk
# # unique(machalilla.raw$photo_date2)
machalilla.raw$camera_trap_start_date<-as.Date(substr(as.character(machalilla.raw$camera_trap_start_time), start=1, stop=11), "%d-%b-%Y")
machalilla.raw$camera_trap_end_date<-as.Date(substr(as.character(machalilla.raw$camera_trap_end_time), start=1, stop=11), "%d-%b-%Y")
#################################
# Fix 2011 problem
# Two cameras have date wrong
# CT-PNM-1-7  and  CT-PNM-3-10
# Fix start date manually
################################
# identify the problem
# index_problem_2011<-which(machalilla.raw$camera_trap_start_date == "2011-11-11")
# problem_2011<-machalilla.raw[index_problem_2011,]
# unique(problem_2011$camera_trap)
# fix 1-7 just year
index_1_07<-which(machalilla.raw$camera_trap == "CT-PNM-1-7")
cam_1_07<-machalilla.raw[index_1_07, ] # make data frame using the cam
machalilla.raw<-machalilla.raw[-index_1_07 ,] # remove the cam
cam_1_07$camera_trap_start_date<-as.Date("2014-09-23", format="%Y-%m-%d")
cam_1_07<-cam_1_07[-1,] # borra el primero porblematic 2011
cam_1_07$photo_type[1]<-"Start" # fix start
cam_1_07$camera_trap_end_date<-as.Date("2014-11-06", format="%Y-%m-%d")
# fix 1-10  # add 31 days since data setup pickup en data 12 and beyond
index_1_10<-which(machalilla.raw$camera_trap == "CT-PNM-1-10")
cam_1_10<-machalilla.raw[index_1_10, ]
machalilla.raw<-machalilla.raw[-index_1_10 ,]
cam_1_10$camera_trap_start_date<-as.Date("2014-09-23", format="%Y-%m-%d")
cam_1_10$camera_trap_end_date<-as.Date("2014-11-05", format="%Y-%m-%d")
cam_1_10$photo_date2[c(12:875)]<-cam_1_10$photo_date2[c(12:875)] +31
# delete problematic data
cam_1_10<-cam_1_10[-24,]
cam_1_10<-cam_1_10[-25,]
# fix 3-10  # restar 30 dias
index_3_10<-which(machalilla.raw$camera_trap == "CT-PNM-3-10")
cam_3_10<-machalilla.raw[index_3_10, ]
machalilla.raw<-machalilla.raw[-index_3_10 ,]
cam_3_10$camera_trap_start_date<-as.Date("2015-01-27", format="%Y-%m-%d")
cam_3_10$camera_trap_end_date<-as.Date("2015-03-15", format="%Y-%m-%d")
# borra los primeros 30 problematicos con fecha 2011
cam_3_10<-cam_3_10[-c(1:30),]
cam_3_10$photo_date2<-cam_3_10$photo_date2  - 30
# fix 3-07 # add difference of 365 days
index_3_07<-which(machalilla.raw$camera_trap == "CT-PNM-3-07")
cam_3_07<-machalilla.raw[index_3_07, ]
machalilla.raw<-machalilla.raw[- index_3_07 ,]
cam_3_07$camera_trap_start_date<-as.Date("2015-01-27", format="%Y-%m-%d")
cam_3_07$camera_trap_end_date<-as.Date("2015-03-11", format="%Y-%m-%d")
cam_3_07$photo_date2<- cam_3_07$photo_date2 + 365
### remove from machalilla.raw
# machalilla.raw<-machalilla.raw[-index_1_07 ,]
# machalilla.raw<-machalilla.raw[-index_3_10 ,]
# machalilla.raw<-machalilla.raw[-index_3_07 ,]
#### Add corrected
machalilla.raw<-rbind(machalilla.raw, cam_1_07, cam_1_10, cam_3_10, cam_3_07)
# machalilla.raw<-rbind(machalilla.raw, cam_1_10)
# machalilla.raw<-rbind(machalilla.raw, cam_3_10)
# machalilla.raw<-rbind(machalilla.raw, cam_3_07)
#  problematic ?
# which(machalilla.raw$photo_date2 == "2011-11-11")
# which(machalilla.raw$camera_trap == "CT-PNM-1-10")
########## extract yr and month
machalilla.raw$year<-year(machalilla.raw$photo_date2)
machalilla.raw$month<-month(machalilla.raw$photo_date2)
# problem?
# which(machalilla.raw$year == "2011")
####################################
# Save as R Data
####################################
machalilla.fixed<-machalilla.raw
save(machalilla.fixed, file = "data/machalilla_fixed.RData")
library(lubridate)
# library(dplyr)
library(maptools)
# Load 'rgdal' package, which is used to read/write shapefiles and rasters
library(rgdal)
source("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/code/TEAM_code.R")
# source("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/code/calendar.R")
load(file = "data/machalilla_fixed.RData")
# library(dplyr)
mat.per.sp<-f.matrix.creator2(data = machalilla.fixed,year = 2014)
sp.names<-names(mat.per.sp) # species names
# counting how many (total) records per species by all days
cont.per.sp<-data.frame(row.names = sp.names)
row.per.sp<-as.data.frame(matrix(nrow = length(sp.names), ncol=c(59)))
col.per.sp<-as.data.frame(matrix(nrow = length(sp.names), ncol=c(161)))
rownames(row.per.sp)<-sp.names
rownames(col.per.sp)<-sp.names
for (i in 1:length(mat.per.sp)){
cont.per.sp[i,1]<-sum(apply(as.data.frame(mat.per.sp [[i]]),FUN=sum,na.rm=T, MARGIN = 1))
row.per.sp[i,]<-apply(mat.per.sp[[i]],1, function(x) sum(x, na.rm=T))
# row.per.sp[i,which(row.per.sp[i,]>0)]<-1 # convert to presence absence  1 and 0
col.per.sp[i,]<-apply(mat.per.sp[[i]],2, function(x) sum(x, na.rm=T))
# col.per.sp[i,which(col.per.sp[i,]>0)]<-1 # convert to presence absence  1 and 0
}
#### se full mat
row.per.sp
##################################################
### Just wild mammals not including domesticated
##################################################
# Chk names in sp.names Myotis myotis should be Artibeus sp
row.per.sp<-row.per.sp[-37,] # elimina Pheucticus chrysogaster
row.per.sp<-row.per.sp[-36,] # elimina Cathartes aura
row.per.sp<-row.per.sp[-35,] # elimina Gallus gallus
row.per.sp<-row.per.sp[-34,] # elimina Zenaida auriculata
row.per.sp<-row.per.sp[-33,] # elimina Momotus momota
row.per.sp<-row.per.sp[-30,] # elimina Heliomaster longirostris
row.per.sp<-row.per.sp[-29,] # elimina Pipistrellus pipistrellus
row.per.sp<-row.per.sp[-26,] # elimina Ortalis vetula
row.per.sp<-row.per.sp[-25,] # elimina Homo sapiens
row.per.sp<-row.per.sp[-21,] # elimina Tinamus major
row.per.sp<-row.per.sp[-16,] # elimina Equus africanus
row.per.sp<-row.per.sp[-15,] # elimina Sus scrofa
row.per.sp<-row.per.sp[-14,] # elimina Rattus rattus
row.per.sp<-row.per.sp[-12,] # elimina Equus ferus
row.per.sp<-row.per.sp[-10,] # elimina Bos primigenius
row.per.sp<-row.per.sp[-07,] # elimina Buteogallus urubitinga
row.per.sp<-row.per.sp[-04,] # elimina Leptotila verreauxi
row.per.sp<-row.per.sp[-03,] # elimina Capra aegagrus
row.per.sp<-row.per.sp[-02,] # elimina Canis lupus
row.per.sp<-row.per.sp[-01,] # elimina 1a sp
# row.per.sp<-row.per.sp[-10,] # elimina Leptotila verreauxi
# row.per.sp<-row.per.sp[-08,] # elimina Tinamus major
# row.per.sp<-row.per.sp[-01,] # elimina 1era especie vacia
######### CHK names
rownames(row.per.sp)
length(row.per.sp[,1])
1/0.06
6/60
1/60
1/0.06
1/.6
100/90
1.27*100
1/60
1/90
row.per.sp
count(row.per.sp)
presence<-row.per.sp$V1[row.per.sp$V1 > 0] <- 1
presence
row.per.sp
presence<-row.per.sp
presence[presence > 0]<-1
presence
naiveoccu<-apply(X = presence,FUN = sum, MARGIN = 2 )
naiveoccu
naiveoccu<-apply(X = presence,FUN = sum, MARGIN = 1 )
naiveoccu
naiveoccu<-apply(X = presence,FUN = sum, MARGIN = 1 ) / 59
naiveoccu
naiveoccu<-apply(X = presence,FUN = sum, MARGIN = 1 )
naiveoccu
naiveoccu
events<-apply(X = row.per.sp ,FUN = sum, MARGIN = 1 )
events
6840/30
6840/60
RAI<-(events/6840) * 100 #6840 is total sampling effort
RAI
RAI<-(events/114) * 100 #6840 is total sampling effort
RAI
114 * 59
RAI<-(events/(114 * 59)) * 100 #114 is total sampling effort in days
RAI
114/3
1stTable<-cbind(events, RAI, naiveoccu )
Table1<-cbind(events, RAI, naiveoccu)
Table1
kable(Table1, format = "markdown")
library(knitr)
kable(Table1, format = "markdown")
kable(Table1, format = "rst")
kable(Table1, format = "pandoc")
kable(Table1, format = "html")
kable(Table1, format = "rst")
RAI
RAI[1]
RAI[,1]
source("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/code/TEAM_code.R")
# source("C:/Users/Diego/Documents/CodigoR/ULEAM/Infor_Caract/code/calendar.R")
load(file = "data/machalilla_fixed.RData")
#machalilla.fixed<-read.csv("C:/Users/Diego/Documents/CodigoR/Machalilla_paper/data/machalilla_fixed.csv")
#machalilla.fixed$photo_date2<-as.Date(as.character(machalilla.fixed$camera_trap_start_date),  "%Y-%m-%d")
#machalilla.fixed$Sampling.Period<-as.numeric(machalilla.fixed$Sampling.Period)
#machalilla.fixed$binomial<-as.character(machalilla.fixed$binomial)
#machalilla.fixed$year<-as.numeric(machalilla.fixed$year)
#machalilla.fixed$month<-as.numeric(machalilla.fixed$month)
#machalilla.fixed$camera_trap_start_date<-as.Date(as.character(machalilla.fixed$camera_trap_start_date),  "%Y-%m-%d")
#machalilla.fixed$camera_trap_end_date<-as.Date(as.character(machalilla.fixed$camera_trap_end_date),  "%Y-%m-%d")
# library(dplyr)
mat.per.sp<-f.matrix.creator2(data = machalilla.fixed,year = 2014)
sp.names<-names(mat.per.sp) # species names
# counting how many (total) records per species by all days
cont.per.sp<-data.frame(row.names = sp.names)
row.per.sp<-as.data.frame(matrix(nrow = length(sp.names), ncol=c(59)))
col.per.sp<-as.data.frame(matrix(nrow = length(sp.names), ncol=c(161)))
rownames(row.per.sp)<-sp.names
rownames(col.per.sp)<-sp.names
for (i in 1:length(mat.per.sp)){
cont.per.sp[i,1]<-sum(apply(as.data.frame(mat.per.sp [[i]]),FUN=sum,na.rm=T, MARGIN = 1))
row.per.sp[i,]<-apply(mat.per.sp[[i]],1, function(x) sum(x, na.rm=T))
# row.per.sp[i,which(row.per.sp[i,]>0)]<-1 # convert to presence absence  1 and 0
col.per.sp[i,]<-apply(mat.per.sp[[i]],2, function(x) sum(x, na.rm=T))
# col.per.sp[i,which(col.per.sp[i,]>0)]<-1 # convert to presence absence  1 and 0
}
#### se full mat
row.per.sp
# colnames(row.per.sp)<-rep
# cont.per.sp$especie<-rownames(cont.per.sp)
# colnames(cont.per.sp)<-c("Numero_de_fotos","especie")
##################################################
### Just wild mammals not including domesticated
##################################################
# Chk names in sp.names Myotis myotis should be Artibeus sp
row.per.sp<-row.per.sp[-37,] # elimina Pheucticus chrysogaster
row.per.sp<-row.per.sp[-36,] # elimina Cathartes aura
row.per.sp<-row.per.sp[-35,] # elimina Gallus gallus
row.per.sp<-row.per.sp[-34,] # elimina Zenaida auriculata
row.per.sp<-row.per.sp[-33,] # elimina Momotus momota
row.per.sp<-row.per.sp[-30,] # elimina Heliomaster longirostris
row.per.sp<-row.per.sp[-29,] # elimina Pipistrellus pipistrellus
row.per.sp<-row.per.sp[-26,] # elimina Ortalis vetula
row.per.sp<-row.per.sp[-25,] # elimina Homo sapiens
row.per.sp<-row.per.sp[-21,] # elimina Tinamus major
row.per.sp<-row.per.sp[-16,] # elimina Equus africanus
row.per.sp<-row.per.sp[-15,] # elimina Sus scrofa
row.per.sp<-row.per.sp[-14,] # elimina Rattus rattus
row.per.sp<-row.per.sp[-12,] # elimina Equus ferus
row.per.sp<-row.per.sp[-10,] # elimina Bos primigenius
row.per.sp<-row.per.sp[-07,] # elimina Buteogallus urubitinga
row.per.sp<-row.per.sp[-04,] # elimina Leptotila verreauxi
row.per.sp<-row.per.sp[-03,] # elimina Capra aegagrus
row.per.sp<-row.per.sp[-02,] # elimina Canis lupus
row.per.sp<-row.per.sp[-01,] # elimina 1a sp
# row.per.sp<-row.per.sp[-10,] # elimina Leptotila verreauxi
# row.per.sp<-row.per.sp[-08,] # elimina Tinamus major
# row.per.sp<-row.per.sp[-01,] # elimina 1era especie vacia
######### CHK names
rownames(row.per.sp)
# Numero de especies observadas
length(row.per.sp[,1])
############################################################
## first Table
############################################################
library(knitr)
presence<-row.per.sp
presence[presence > 0]<-1 # replace to 1
naiveoccu<-apply(X = presence,FUN = sum, MARGIN = 1 ) / 59 #divided number of sites
events<-apply(X = row.per.sp ,FUN = sum, MARGIN = 1 )
RAI<-(events/(114 * 59)) * 100 #114 is total sampling effort in days
Table1<-cbind(events, RAI, naiveoccu)
kable(Table1, format = "rst")
114 * 59
6840 / 59
116 * 59
col.per.sp
161 / 59
161 * 59
59 * 116
6844 / 116
6844 / 59
31.34 * 58
59 * 35
mat.per.sp[5]
image(t(mat.per.sp[5]))
image(t(as.matrix(mat.per.sp[5])))
image(as.matrix(mat.per.sp[5]))
35.6 * 59
36.2 * 59
37.2 * 59
114 / 3
37.5 * 59
37.6 * 59
37.8 * 59
presence<-row.per.sp
presence[presence > 0]<-1 # replace to 1
naiveoccu<-apply(X = presence,FUN = sum, MARGIN = 1 ) / 59 #divided number of sites
events<-apply(X = row.per.sp ,FUN = sum, MARGIN = 1 )
RAI<-(events/(37.8 * 59)) * 100 #114 is total sampling effort in days
Table1<-cbind(events, RAI, naiveoccu)
kable(Table1, format = "rst")
